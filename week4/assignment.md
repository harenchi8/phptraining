
# 第4週 実践課題

この課題では、phpMyAdminでデータベースとテーブルを準備し、PHP(PDO)を使ってデータベースと連携する基本的な顧客一覧アプリを作成します。

---

## 課題1: データベースとテーブルの準備 (9/13)

**目的:**
phpMyAdminを使い、アプリケーションで利用するデータベースとテーブルをGUIで作成する方法を学びます。

**手順:**

1.  XAMPPを起動し、phpMyAdminにアクセスします。
2.  **データベースの作成**:
    *   左のメニューまたは「データベース」タブから、新しいデータベースを作成します。
    *   データベース名: `php_training_db`
    *   照合順序: `utf8mb4_general_ci` を選択して作成します。
3.  **テーブルの作成**:
    *   作成した `php_training_db` データベースを選択します。
    *   「テーブルを作成」セクションで、以下の仕様の `customers` テーブルを作成します。
        *   テーブル名: `customers`
        *   カラム数: 4
    *   **カラム定義:**
        1.  **`id`**: `INT`, `AUTO_INCREMENT` (A_I) にチェック, `PRIMARY` (主キー)
        2.  **`name`**: `VARCHAR`, 長さ `100`
        3.  **`email`**: `VARCHAR`, 長さ `255`
        4.  **`created_at`**: `DATETIME`, デフォルト `CURRENT_TIMESTAMP`
    *   保存ボタンを押してテーブルを作成します。
4.  **テストデータの挿入**:
    *   作成した `customers` テーブルを選択し、「挿入」タブを開きます。
    *   `name` と `email` に適当なテストデータを2〜3件入力して、手動でデータを登録しておきます。（`id`と`created_at`は自動で入ります）

---

## 課題2: 顧客一覧表示アプリの作成 (SELECT) (9/13)

**目的:**
PDOを使ってデータベースに接続し、`SELECT`文で取得したデータをWebページに表示する方法を学びます。

**手順:**

1.  `htdocs`ディレクトリに `db_connect.php` と `customer_list.php` の2つのファイルを作成します。

2.  **`db_connect.php`** の要件:
    *   PDOを使って `php_training_db` データベースに接続する処理を記述します。
    *   DSN、ユーザー名、パスワードを正しく設定してください。
    *   `try-catch`構文を使い、接続に失敗した場合はエラーメッセージを表示して処理を終了するようにします。
    *   このファイルは、データベース接続の部品として他のファイルから `require_once` で読み込んで使います。

3.  **`customer_list.php`** の要件:
    *   `require_once 'db_connect.php';` でDB接続ファイルを読み込みます。
    *   `customers` テーブルから全ての顧客データを取得する `SELECT` 文を実行します。
    *   `fetchAll(PDO::FETCH_ASSOC)` を使って、結果を連想配列の配列として取得します。
    *   取得したデータをHTMLのテーブル(`<table>`, `<tr>`, `<td>`)を使って、一覧形式で画面に表示します。
    *   表示項目は「ID」「氏名」「Email」「登録日時」とします。

**動作確認:**

1.  ブラウザで `http://localhost/customer_list.php` にアクセスします。
2.  phpMyAdminで登録した顧客データが、HTMLのテーブルで正しく表示されることを確認します。

---

## 課題3: フォーム入力からDB登録→表示 (INSERT) (9/14)

**目的:**
HTMLフォームからの入力を受け取り、プリペアドステートメントを使って安全にデータベースへ登録(INSERT)し、登録後のデータを一覧に表示する流れを実装します。

**手順:**

1.  `htdocs`ディレクトリに `add_customer.php` というファイルを作成します。
2.  **`add_customer.php`** の要件:
    *   **GETリクエストの場合 (通常アクセス時)**:
        *   「氏名」と「Email」を入力するHTMLフォームを表示します。
        *   フォームの送信先は `add_customer.php` 自身、メソッドは `POST` とします。
    *   **POSTリクエストの場合 (フォーム送信時)**:
        *   `require_once 'db_connect.php';` でDB接続を読み込みます。
        *   POSTされた氏名とEmailを取得します。
        *   （簡単のためバリデーションは省略しますが、本来は必須です）
        *   プリペアドステートメントを使って、`customers` テーブルに新しい顧客データを `INSERT` します。
        *   `name` と `email` をプレースホルダでバインドしてください。
        *   登録処理が完了したら、`customer_list.php` にリダイレクトして、登録結果が反映された一覧画面を表示します。
3.  `customer_list.php` を修正し、`add_customer.php` へのリンク（例:「新規顧客登録」）を追加します。

**動作確認:**

1.  `customer_list.php` から「新規顧客登録」リンクをクリックし、`add_customer.php` のフォーム画面に遷移することを確認します。
2.  フォームに新しい顧客の情報を入力して送信します。
3.  `customer_list.php` にリダイレクトされ、今登録した顧客が一覧の末尾に追加されていることを確認します。
4.  phpMyAdminを開き、`customers` テーブルにもデータが正しくINSERTされていることを確認します。
